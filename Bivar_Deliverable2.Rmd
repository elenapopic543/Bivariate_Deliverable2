PUBPOL 543

Deliverable 2: "Bivariate Plot"

Note: The dataset used for this assignment was sourced from the US Government's open data repository: https://catalog.data.gov/ (last accessed, February 5, 2023) 

The dataset contains information on data breach incidents reported by legal entities from different industries. In this, the Washington state laws requires legal entities to notify authorities whenever they have been exposed to data breaches compromising information on more than 500 Washingtonians. 

In this assignment, I will explore the number of Washingtonians affected in data breaches by the type of the industry where the data breach incidents occurred 
(i.e., perform a Categorical-Numerical bivariate relationship analysis).

```{r}
#Providing the link to the data in the Github repository:
location='https://github.com/elenapopic543/Bivariate_Deliverable2/raw/main/'
file='Data_Breach_Notifications_Affecting_Washington_Residents.csv'
link=paste0(location,file)

#Reading-in the data from the Github repository location:
data1 <- read.csv(file=url(link), header=TRUE, stringsAsFactors=FALSE)
```

```{r}
#Examining data types:
#str(data1,width = 70,strict.width='cut')
```

```{r}
#Summarizing the variable reflecting the number of people affected by the data breach:
#summary(data1$WashingtoniansAffected)
```

```{r}
#Excluding the missing values:
data1=na.omit(data1)
```

```{r}
#Getting the median of exposed residents for each industry type:
aggregate(data=data1, WashingtoniansAffected~IndustryType,median)
```

```{r}
library(dplyr)
#Simplifying the name of the variable: 
data1 = data1 %>%
mutate(IndustryType = if_else(IndustryType == "Non-Profit/Charity", "Non-Profit", IndustryType))
unique(data1$IndustryType)
```

```{r}
#Getting the mean of exposed residents for each industry type:
aggregate(data=data1, WashingtoniansAffected~IndustryType,mean)
```

```{r}
#Checking other statistics:
tapply(data1$WashingtoniansAffected,
       data1$IndustryType, summary)
```

The above summary statistics point out that half of the data breach incidents occurring in each industry type are affecting from roughly 1400 to 2400 WA residents. The incidents with a large number of exposed people are less common in each industry type, but certain industries appear to be more prone to such large scale exposures. I will reflect these findings in the following boxplot:

```{r}
library(ggplot2)
library(ggpubr)

base1=ggplot(data=data1[data1$WashingtoniansAffected>=1500,],
            aes(x=IndustryType,y=WashingtoniansAffected)) 
box1=base1 + geom_boxplot() + labs(title = "1.5k residents and above")

base2=ggplot(data=data1[data1$WashingtoniansAffected>=20000,],
            aes(x=IndustryType,y=WashingtoniansAffected))
box2=base2 + geom_boxplot() + labs(title = "20k residents and above")

base3=ggplot(data=data1[data1$WashingtoniansAffected>=100000,],
            aes(x=IndustryType,y=WashingtoniansAffected)) 
box3=base3 + geom_boxplot() + labs(title = "100k residents and above")

#ggarrange(box1,box2,box3,ncol = 1)
```

```{r}
#Moving forward, I will focus my analysis on data breach incidents that affected 10k people or more.

titleText2="Data Breaches Affecting over 10,000 People by Industry of Occurrence (WA, 2016-2022)"
sourceText='Source: DATA.GOV'
base4=ggplot(data=data1[data1$WashingtoniansAffected>=10000,],
            aes(x=IndustryType,y=WashingtoniansAffected)) 
box4=base4 + geom_boxplot() + labs(title = titleText2)

#box4 + coord_flip()
```

```{r}
#Reordering by the median value of incidents:
base5=ggplot(data=data1[data1$WashingtoniansAffected>=10000,],
            aes(x=reorder(IndustryType,
                          WashingtoniansAffected,
                          median),
                y=WashingtoniansAffected)) 
box4=base4 + geom_boxplot() + labs(title = titleText2)

#box5  + coord_flip()
```


```{r}
#Creating a histogram:
baseHY=ggplot(data=data1[data1$WashingtoniansAffected>=10000,],
            aes(x=WashingtoniansAffected)) 
histHY=baseHY + geom_histogram(aes(fill=IndustryType), 
                              color='black') + scale_x_continuous(limits = c(0,500000),
labels = c("100000","500000","1000000","2000000","3000000")) + labs(title =titleText2)
#histHY
```


```{r}
#Adding facets and further customizing the axes of the plot:
baseHY=ggplot(data=data1[data1$WashingtoniansAffected>=10000,],
            aes(x=WashingtoniansAffected)) 
histHY=baseHY + geom_histogram(aes(fill=IndustryType), 
                              color='black') + labs(title = titleText2, caption = sourceText, 
                              x = "Number of People Affected", y = "Number of Data Breaches",) +
scale_x_continuous(limits = c(0,500000), 
labels = c( "50000", "100000","200000","300000","400000","500000"))
#histHY + facet_grid(~IndustryType)
```

```{r}
histHY2 = histHY + theme(plot.caption = element_text(hjust = 0, margin = margin(t = 5), size=8), 
                   plot.title = element_text(hjust = 0.5, margin = margin(b = 10), size = 12),
                   axis.title.x = element_text(margin = margin(t = 8), size=10), 
                   axis.title.y = element_text(margin = margin(r = 8), size=10))
histHY2 + facet_grid(IndustryType~.) + guides(fill="none")
```



